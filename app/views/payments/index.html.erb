<p id="notice"><%= notice %></p>

<h1>Listing Payments</h1>

<table>
  <thead>
    <tr>
      <th>type</th>
      <th>payment/subscription date</th>
      <th>firstname</th>
      <th>lastname</th>
      <th colspan="2">gender</th>
      <th>email</th>
      <th colspan="2">spefz_user_ref | [db_id]</th>
      <th colspan="2">spefz_payment_ref | [db_id]</th>
      <th colspan="2">spefz_event_ref | [db_id]</th>
      <th colspan="2">spefz_subscription_ref | [db_id]</th>
      <td colspan="2">product</td>
      <!-- <td>product_price</td> -->
      <th>[Stripe] Customer_id</th>
      <th>[Stripe] Subscription_id [check in strip to verify]<</th>
      <th>[Stripe] Payment_id [check in strip to verify]</th>
      <th>Subscription Payment Date</th>
      <th>Event Payment Date</th>
      <th>card type</th>
      <th colspan="3">Card Details</th>
      <th>status</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @payments.each do |payment| %>
      <tr>
        <td>
          <% if payment.event_id? %>
            <%= "payment" %>
          <% elsif payment.subscription_id? %>
            <%= "subscription" %>
          <% end %>
        </td>
        <td><%= payment.created_at %></td>
        <td><%= payment.user.firstname %></td>
        <td><%= payment.user.lastname %></td> 
        <td><%= payment.user.category_gender.name %></td> <td>[<%= payment.user.category_gender_id %>]</td>
        <td><%= payment.email %></td>
        <td><%= payment.user.reference %></td> <td>[<%= payment.user_id %>]</td>
        <td><%= payment.reference %></td> <td>[<%= payment.id %>]</td>
        <td>
          <% if payment.event_id? %>
          <%= payment.event.reference %>
          <% else %>
            <%= "-" %>
          <% end %>
        </td> <td>[<%= payment.event_id %>]</td>
        <td>
          <% if payment.subscription_id? %>
            <%= payment.subscription.reference %>
          <% else %>
            <%= "-" %>
          <% end %>
        </td> <td>[<%= payment.subscription_id %>]</td>
        <td>
          <% if payment.event_id? %>
            <%= payment.event.title %>
          <% elsif payment.subscription_id? %>
            <%= payment.subscription.title %> plan
          <% end %>
        </td>
        <td>
          <% if payment.event_id? %>
            <%= payment.event.price %>
          <% elsif payment.subscription_id? %>
            <%= payment.subscription.price %>
          <% end %>
        </td>
        <td><%= payment.stripe_customer_id %></td>
        <td><%= payment.stripe_subscription_id %></td>
        <td><%= payment.stripe_payment_id %></td>
        <td><%= payment.subscription_payment_date %></td>
        <td><%= payment.event_payment_date %></td>
        <td><%= payment.user_card_type %></td>
        <td><%= payment.user_card_last4 %></td>
        <td><%= payment.user_card_exp_month %></td>
        <td><%= payment.user_card_exp_year %></td>
        <td><%= payment.status %></td>
        <td><%= link_to 'Show', payment %></td>
        <td><%= link_to 'Edit', edit_payment_path(payment) %></td>
        <td><%= link_to 'Destroy', payment, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Payment', new_payment_path %>


